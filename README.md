# Project references
Thank you for your creativity
[https://github.com/dmak/merge2pdf.git](https://github.com/dmak/merge2pdf.git).

# Merge2PDF

[![Build Status](https://travis-ci.org/dmak/merge2pdf.svg)](https://travis-ci.org/dmak/merge2pdf)
[![Coverage Status](https://coveralls.io/repos/github/dmak/merge2pdf/badge.svg?branch=master)](https://coveralls.io/github/dmak/merge2pdf?branch=master)

If you like this utility, please give in a star in GutHub! Report the issues to [bugtracker](https://github.com/dmak/merge2pdf/issues/).

## Description

This utility allows one to "convert" JPEG to PDF without recompression. More generally, it combines a sequence of PDF, JPEG, TIFF, PNG images into one PDF.  

The code was originally posted [here](https://stackoverflow.com/questions/46664134/merge-pdf-documents-and-images-into-one-pdf), and later evolved into a more powerful utility. 

The question about JPEG-to-PDF conversion was asked several times (see [here](https://askubuntu.com/questions/246647/jpeg-files-to-pdf)), however it is known that [GraphicsMagick](http://www.graphicsmagick.org/) uses [GhostScript](https://www.ghostscript.com/) under the hood, which performs image decompression and then compression (check [this answer comments](https://askubuntu.com/a/473674/164142)) hence `gm convert image.jpg image.pdf` does not fit.

Further, [`pdftk`](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/ ) and [`qpdf`](http://qpdf.sourceforge.net/files/qpdf-manual.html) only take PDF as input, not images. Hence PDF should be created from images upfront and later taken by one of these utilities.

The only utility which does combining of images efficiently is [`img2pdf`](https://gitlab.mister-muffin.de/josch/img2pdf), written in Python.

I have also done small research and examined PDFs generated by several online services.

These do not perform recompression, but they are online services or commercial products:

add command --based 依据文件夹 --from 来源文件夹 --to 目标文件夹
根据pdf文件名称，截取前八位，和N个截取的名称做比较，如果相同，拼接为一个文件。

*  http://convert-my-image.com/ – based on [iText PDF 5.3.0](https://itextpdf.com/)
*  https://www.pdfpro.co/ – uses [BCL easyPDF](http://www.pdfonline.com/easypdf/)

These services perform recompression:

* https://www.freepdfconvert.com/jpg-pdf
* http://jpg2pdf.com/
* http://www.jpgtopdf.com/

### Extras

* Additional information about how "correct" merge should work is given in book ["PDF Explained" by John Whitington (2011), p.109, ISBN 1449310028](https://books.google.nl/books?id=1TpDgwNGIK8C&pg=PA109&lpg=PA109).
* [Duplicate TTF font merging and replacement](http://itext.2136553.n4.nabble.com/How-to-remove-embedded-fonts-from-a-pdf-document-td2166185.html#d1201780152717-553), [Fonts and merging documents](https://itextpdf.com/en/resources/examples/itext-5/fonts-and-merging-documents).
* [Unembed a font](https://itextpdf.com/en/resources/examples/itext-5/unembed-font).

## Usage

`java -jar merge2pdf.jar -m [-d] [-s dim] [-Anum] [-g pos] [-b num] one.pdf [two.jpg three.png ...] out.pdf`

`java -jar merge2pdf.jar -e [-p directory/file_prefix] in.pdf`

`java -jar merge2pdf.jar [-v|-h]`

<table>
<tr>
	<th>Option</th>
	<th>Comment</th>
</tr>
<tr>
	<td><tt>-m|--merge</tt></td>
	<td>Merge PDF/image files that follow into one PDF.</td>
</tr>
<tr>
	<td><tt>-d|--dpi</tt></td>
	<td>If image metainformation provides DPI, then scale the image down, namely to <tt>72 / image_DPI × 100%</tt>, where 72 DPI is a standard PDF DPI. This is necessary in case one needs to merge images with different DPI so that they are represented on the same scale in resulting PDF.</td>
</tr>
<tr>
	<td><tt>-s|--scale</tt></td>
	<td>Scale down (if necessary) image so that it fits provided box given as a page (A4) or dimension in pixels (180x20).</td>
</tr>
<tr>
	<td><tt>-An</tt>, e.g. <tt>-A3</tt>, <tt>-A4</tt>, <tt>-A5</tt>, ...</td>
	<td>Scale the image down to fit the given page size (A3, A4, ...). Auto-rotation is applied, i.e. if image width is bigger than height and the image does not fit the portrait-oriented page, page orientation is set to landscape and then the image is scaled down (if necessary). Images are anchored to the top-left corner.</td>
</tr>
<tr>
	<td><tt>-g|--gravity</tt></td>
	<td>Place an image to the page at given corner. Requires that page size is given (e.g. <tt>-A4</tt>, see above). Possible values (case insensitive): center / centre, top / north, topright / northeast, right / east, bottomright / southeast, bottom / south, bottomleft / southwest, left / west, topleft / northwest.</td>
</tr>
<tr>
	<td><tt>-b|--border</tt></td>
	<td>When adding images, pad them with given border.</td>
</tr>
<tr>
	<td><tt>-r|--remove-font</tt></td>
	<td>When reading input PDFs, remove the specified embedded font(s) thus reducing the output PDF size. Font name is given as regular expression where empty argument (<tt>-r ""</tt>) means <tt>".*"</tt> i.e. remove all embedded fonts.</td>
</tr>
<tr>
	<td><tt>-e|--extract</tt></td>
	<td>Extract images from given PDF. Images get automatic suffixes like <tt>_1</tt>, <tt>_2</tt>, etc and appropriate extension (<tt>.jpg</tt>, <tt>.png</tt>). Note that this function is still experimental as it does not fully support extraction of TIFF files, which are saved in PNG format.</td>
</tr>
<tr>
	<td><tt>-p|--prefix</tt></td>
	<td>Use given directory or directory + file as a prefix. If omitted, the current directory is used to save extracted files.</td>
</tr>
<tr>
	<td><tt>-v|--version</tt></td>
	<td>Print version and exit.</td>
</tr>
<tr>
	<td><tt>-h|--help</tt></td>
	<td>Print help and exit.</td>
</tr>
</table>

Note that output PDF is overwritten without any warnings.

### Examples

* `java -jar merge2pdf.jar --merge 1.jpg 2.tiff all.pdf` – merge images `1.jpg` and `2.tiff` into `all.pdf` as is, i.e. each image forms a separate page with the size equal to image

* `java -jar merge2pdf.jar --merge -A3 -b20 -rArial 1.pdf 2.png 3.png out.pdf` – append images `2.jpg` and `3.png` to `1.pdf` and save the resulting PDF to `out.pdf`; the images are placed to page size A3 padded with border 10 pixels, resized (if necessary) to fit the given page and centered; the embedded font Arial is removed (if found)

* `java -jar merge2pdf.jar --merge --dpi -scale 200x100 view1.jpg view2.jpg all.pdf` – merge images `view1.jpg` and `view1.jpg` into `all.pdf`; the images are first scaled according to DPI (that means for example that image with 300dpi is twice smaller than image with 150dpi) and then scaled down (if don't fit) the given box with width 200px and height 100px.

## Development / Contribution

Please follow [Contribution section](https://github.com/dmak/jaxb-xew-plugin#contribution). 

## License

The whole project is licensed under [AGPLv3](https://www.gnu.org/licenses/agpl-3.0.en.html).
